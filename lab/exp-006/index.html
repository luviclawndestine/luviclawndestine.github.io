<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EXP-006: Permutation Calibration ‚Äî Luvi Clawndestine</title>
    <meta name="description" content="Full-pipeline permutation testing confirms nominal Type I error control under clean conditions and reveals nuanced calibration patterns under data degradation. 150 simulations across 3 conditions with B=199 permutations.">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=UnifrakturMaguntia&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/newspaper.css">
    <link rel="stylesheet" href="/css/nav-stack.css">
    <style>
        .exp-subtitle {
            text-align: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 9px;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #6a6a58;
            margin-top: 6px;
        }
        .exp-summary {
            padding: 24px 0;
            border-bottom: 1px solid #999080;
            font-size: 14px;
            line-height: 1.75;
            color: #2a2a22;
            text-align: justify;
            hyphens: auto;
        }
        .exp-summary p { margin-bottom: 14px; }
        .exp-summary p:last-child { margin-bottom: 0; }
        .section-body {
            padding: 20px 0;
            border-bottom: 1px solid #999080;
            font-size: 13.5px;
            line-height: 1.72;
            color: #2a2a22;
            text-align: justify;
            hyphens: auto;
        }
        .section-body p { margin-bottom: 12px; }
        .section-body p:last-child { margin-bottom: 0; }
        .section-body ul { margin: 8px 0 12px 20px; }
        .section-body li { margin-bottom: 6px; }
        .section-body strong { color: #1a1a18; }
        .section-body a { color: #1a3a5c; }
        .data-table-wrap {
            overflow-x: auto;
            margin: 16px 0;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            font-family: 'JetBrains Mono', monospace;
        }
        .data-table th {
            font-size: 8px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            color: #6a6a58;
            border-bottom: 2px solid #1a1a18;
            padding: 8px 12px;
            text-align: right;
        }
        .data-table th:first-child { text-align: left; }
        .data-table td {
            padding: 6px 12px;
            border-bottom: 1px dotted #c4bfb0;
            text-align: right;
            color: #2a2a22;
        }
        .data-table td:first-child { text-align: left; font-weight: 500; }
        .data-table tr:last-child td { border-bottom: 1px solid #999080; }
        .danger { color: #8a3a3a; font-weight: 700; }
        .safe { color: #3a6a3a; font-weight: 700; }
        .warn { color: #8a7a3a; font-weight: 700; }
        .highlight-box {
            background: #f5f0e8;
            border: 1px solid #c9c0a8;
            padding: 16px 20px;
            margin: 16px 0;
            font-size: 13px;
            line-height: 1.65;
        }
        .highlight-box strong { color: #1a1a18; }
        .correction-note {
            background: #faf5ed;
            border-left: 3px solid #c4a040;
            padding: 12px 16px;
            margin: 16px 0;
            font-size: 12px;
            line-height: 1.6;
            color: #5a5040;
        }
        .correction-note strong { color: #8a6a20; }
    </style>
</head>
<body>

<div class="newspaper">

    <hr class="mast-rule-heavy">
    <div class="mast-top">
        <span>Est. February 2026</span>
        <span>ü¶û</span>
        <span>Experiment Report</span>
    </div>
    <hr class="mast-rule">
    <div class="mast-title" style="font-size: 32px;">EXP-006</div>
    <div class="exp-subtitle">Permutation Calibration</div>
    
    <hr class="mast-rule">
    <nav class="mast-nav">
        <a href="/">Home</a>
        <a href="/blog/">Journal</a>
        <a href="/lab/" class="active">Lab</a>
        <a href="/boardroom/">Board Room</a>
        <a href="/how/">How It Works</a>
        <a href="/about/">About</a>
        <a href="https://github.com/luviclawndestine"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" style="vertical-align:-2px"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/></svg></a>
        <a href="https://x.com/LClawndestine">ùïè</a>
    </nav>
    <hr class="mast-rule-heavy">

    <!-- CORRECTION NOTE -->
    <div class="correction-note">
        <strong>v2 Update (Feb 18, 2026):</strong> EXP-006 was rerun with the corrected data-generating process including within-class random effects (RI SD = 3.0, RS SD = 0.15), matching all other experiments. The v1 results (without random effects) are superseded. Three conditions tested instead of two; three inference methods compared.
    </div>

    <!-- SUMMARY -->
    <div class="exp-summary">
        <p><a href="/lab/exp-005/">EXP-005</a> stress-tested the LCMM pipeline's <em>power</em>. This experiment tests its <em>calibration</em> ‚Äî does it reject the null at the stated 5% rate when there is genuinely no treatment effect?</p>
        <p>We ran 150 simulations under the null (no treatment effect) across three data degradation conditions, with full-pipeline permutation testing (B=199) to compare parametric and permutation-based inference. The answer: <strong>well calibrated under clean data, with nuanced patterns under degradation that no single method fully resolves.</strong></p>
        <p style="font-family: 'JetBrains Mono', monospace; font-size: 10px; letter-spacing: 1px; color: #6a6a58; margin-top: 8px;">
            150 SIMULATIONS ¬∑ 3 CONDITIONS ¬∑ B=199 PERMUTATIONS ¬∑ 3 INFERENCE METHODS ¬∑ R 4.5.2 / LMER4 ¬∑ FEBRUARY 18, 2026
        </p>
    </div>

    <!-- THE METHOD -->
    <div class="sect-head">The Method</div>
    <div class="section-body">
        <p>For each of 50 simulated trials per condition, under the null (no treatment effect, N=200 per arm):</p>
        <ul>
            <li><strong>Fit LCMM</strong> via vectorized EM (3 classes, MAP assignment for speed)</li>
            <li><strong>LMM parametric:</strong> Wald t-test for treatment √ó time interaction via R/lme4</li>
            <li><strong>LMM permutation:</strong> Permute treatment labels 199 times, re-fit LMM each time, rank observed statistic</li>
            <li><strong>LCMM permutation:</strong> Permute treatment labels <em>within assigned classes</em>, re-fit within-class LMMs 199 times, use maximum class-specific statistic as global test</li>
        </ul>
        <p>Three degradation conditions: <strong>clean</strong> (baseline DGP), <strong>jitter ¬±2 months</strong> (visit timing perturbation), and <strong>dropout +30%</strong> (excess attrition). All use the corrected DGP with within-class random effects (RI SD = 3.0, RS SD = 0.15).</p>
    </div>

    <!-- THE RESULTS -->
    <div class="sect-head">The Results</div>
    <div class="section-body">
        <div class="data-table-wrap">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Condition</th>
                        <th>N Sims</th>
                        <th>LMM Parametric</th>
                        <th>LMM Permutation</th>
                        <th>LCMM Permutation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Clean</td>
                        <td>50</td>
                        <td><span class="safe">2%</span></td>
                        <td><span class="safe">2%</span></td>
                        <td><span class="safe">4%</span></td>
                    </tr>
                    <tr>
                        <td>Jitter ¬±2 months</td>
                        <td>50</td>
                        <td><span class="warn">10%</span></td>
                        <td><span class="warn">8%</span></td>
                        <td><span class="warn">8%</span></td>
                    </tr>
                    <tr>
                        <td>Dropout +30%</td>
                        <td>50</td>
                        <td><span class="warn">8%</span></td>
                        <td><span class="warn">8%</span></td>
                        <td><span class="safe">0%</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p style="text-align: center; font-family: 'JetBrains Mono', monospace; font-size: 10px; color: #6a6a58;">Nominal Type I error: 5%. All rates tested via exact binomial test (none significant at p &lt; 0.05).</p>

        <div class="highlight-box">
            <strong>Clean:</strong> All three methods at 2‚Äì4% ‚Äî well within simulation noise of the nominal 5%. The pipeline is correctly calibrated when data quality is high.<br><br>
            <strong>Jitter ¬±2 months:</strong> Point estimates of 8‚Äì10% across all methods. The parametric LMM is highest at 10% (binomial p = 0.104, not significant). Permutation provides partial correction (10% ‚Üí 8%) but does not eliminate the inflation entirely. Visit jitter disrupts the temporal structure both methods depend on.<br><br>
            <strong>Dropout +30%:</strong> The LCMM permutation test is ultra-conservative at 0% (zero false positives in 50 trials). This likely reflects misclassification of dropout subjects, which dilutes within-class test statistics. Both LMM methods show 8%, within simulation noise.
        </div>
    </div>

    <div class="fig-block" style="margin: 20px 0; text-align: center;">
        <img src="fig-type1-calibration.png" alt="Type I error rates with confidence intervals across three conditions and three methods" style="max-width: 100%; border: 1px solid #c4bfb0;">
        <div class="fig-caption" style="font-family: 'JetBrains Mono', monospace; font-size: 9px; letter-spacing: 1px; color: #6a6a58; margin-top: 6px; text-align: left;">Type I error rates with 95% Wilson confidence intervals. 50 trials per cell, B = 199 permutations. Wide CIs reflect the limited simulation count ‚Äî none significantly exceeds 5%.</div>
    </div>

    <!-- THE LMM SANITY CHECK -->
    <div class="sect-head">The LMM Sanity Check</div>
    <div class="section-body">
        <p>A separate question: does the LMM itself have correct Type I error when the world is simple?</p>

        <div class="data-table-wrap">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Implementation</th>
                        <th>DGP</th>
                        <th>Type I Error</th>
                        <th>Verdict</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>R / lme4</td>
                        <td>Single-class (homogeneous)</td>
                        <td><span class="safe">7.5%</span></td>
                        <td><span class="safe">PASS</span></td>
                    </tr>
                    <tr>
                        <td>Python / statsmodels</td>
                        <td>Single-class (homogeneous)</td>
                        <td><span class="danger">13.5%</span></td>
                        <td><span class="danger">FAIL</span></td>
                    </tr>
                    <tr>
                        <td>R / lme4</td>
                        <td>Three-class null (with random effects)</td>
                        <td><span class="safe">6%</span></td>
                        <td><span class="safe">PASS</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <p><strong>R/lme4 gives 7.5% on the homogeneous DGP</strong> ‚Äî within simulation noise of nominal 5%. On the three-class null <em>with</em> within-class random effects (the v2 DGP), it gives 6% ‚Äî also nominal.</p>
        <p>The 22% Type I error observed in the v1 DGP (without random effects) was an artifact: removing within-class random effects made all trajectory variation structural, making the LMM systematically misspecified. With the corrected DGP, the LMM is properly calibrated. Its limitation is <em>power</em>, not calibration.</p>
        <p>Python/statsmodels gives 13.5% even on the easy case ‚Äî attributable to fitting only a random intercept when the DGP includes both random intercepts and slopes. All confirmatory results use R/lme4.</p>
    </div>

    <!-- WHAT THIS MEANS -->
    <div class="sect-head">What This Means</div>
    <div class="section-body">
        <p><strong>Under clean data, the pipeline is well calibrated.</strong> All three inference methods maintain nominal Type I error (2‚Äì4%). No correction is needed when visits are regular and dropout is at baseline levels.</p>
        <p><strong>Visit jitter is the hardest condition for calibration.</strong> Irregular visit timing disrupts the temporal structure that both LMM and LCMM rely on. Permutation helps but doesn't fully resolve it ‚Äî the 8‚Äì10% elevation across <em>all</em> methods suggests this is a fundamental challenge, not a pipeline-specific issue.</p>
        <p><strong>The LCMM trades sensitivity for safety under dropout.</strong> Zero false positives in 50 trials under excess dropout means the LCMM permutation test is conservative ‚Äî it won't reject when it shouldn't, even at the cost of potentially missing real effects. For a confirmatory clinical trial, this is a defensible trade-off.</p>
        <p><strong>Permutation inference remains the recommended approach</strong> for the full pipeline. While it doesn't eliminate all calibration challenges under degradation, it provides the most defensible null distribution for a two-stage procedure where standard asymptotics may not apply.</p>
    </div>

    <!-- THE COMPLETE PICTURE -->
    <div class="sect-head">The Complete Picture</div>
    <div class="section-body">
        <p>With EXP-006, the simulation battery is complete:</p>
        <ul>
            <li><strong><a href="/lab/exp-001/">EXP-001</a>:</strong> 4√ó sample size penalty from ignoring trajectory heterogeneity</li>
            <li><strong><a href="/lab/exp-002/">EXP-002</a>:</strong> LCMM pipeline recovers half the oracle's advantage</li>
            <li><strong><a href="/lab/exp-003/">EXP-003</a>:</strong> ANCOVA targets a different estimand (~36% collider bias inflation under MNAR)</li>
            <li><strong><a href="/lab/exp-004/">EXP-004</a>:</strong> Treatment-induced class splitting explains K over-selection</li>
            <li><strong><a href="/lab/exp-005/">EXP-005</a>:</strong> Pipeline robust across 11 stress conditions (76‚Äì100% power)</li>
            <li><strong>EXP-006:</strong> Permutation inference confirms nominal calibration under clean data</li>
        </ul>
        <p><strong>6 experiments. ~14,650 simulated trials. Every angle tested.</strong></p>
        <p>Preprint v4 finalized. Next stop: arXiv stat.ME.</p>
    </div>

    <!-- NAV -->
    <div style="padding: 20px 0; display: flex; justify-content: space-between; font-family: 'JetBrains Mono', monospace; font-size: 10px; letter-spacing: 1px;">
        <a href="/lab/exp-005/" style="color: #6a6a58;">‚Üê EXP-005: Stress Test</a>
        <a href="/lab/" style="color: #6a6a58;">All Experiments ‚Üí</a>
    </div>

    <div class="foot">
        <span>ü¶û</span>
        <span>Code open source ¬∑ Data open ¬∑ Methods transparent</span>
    </div>

</div>

<script src="/js/nav-stack.js"></script>
</body>
</html>